import paramiko
import os
from paramiko import SSHClient


class SSHConnector(SSHClient):

    def __init__(self, hostName, userName="lab", password="lab"):
        self.client = paramiko.SSHClient()
        self.client.set_missing_host_key_policy(paramiko.AutoAddPolicy())
        self.client.connect(
            hostname=hostName,
            username=userName,
            password=password)

    def printRemoteOutput(self, output):
        lines = output.readlines()
        print(*lines)

    def closeConnection(self):
        self.client.close()
        print('[+] Done, connection closed')

    def sendCommand(self, command):
        if(command == "close"):
            self.closeConnection()
        else:
            try:
                stdin, stdout, stderr = self.client.exec_command(command)
                if stdout:
                    self.printRemoteOutput(stdout)
                if stderr:
                    self.printRemoteOutput(stderr)
            except Exception as ex:
                print('[-] Error issuing command: {0}'.format(ex))
